"use strict";var callback=function(){({init:function(){this.moduleName="FareCalculator",this.bemClass="fare-calculator",this.destination=this.easyDataJS({name:this.moduleName+".Destination",selectAll:!1}),this.when=this.easyDataJS({name:this.moduleName+".When",selectAll:!1}),this.whenHelperText=this.easyDataJS({name:this.moduleName+".HelperText.When",selectAll:!1}),this.purchaseLocations=this.easyDataJS({name:this.moduleName+".PurchaseLocation",selectAll:!0}),this.purchaseHelperText=this.easyDataJS({name:this.moduleName+".HelperText.Purchase",selectAll:!1}),this.tickets=this.easyDataJS({name:this.moduleName+".Tickets"}),this.ticketsHelperText=this.easyDataJS({name:this.moduleName+".HelperText.Tickets"}),this.totalFare=this.easyDataJS({name:this.moduleName+".TotalFare"}),this.savingsHelperText=this.easyDataJS({name:this.moduleName+".HelperText.Savings"}),this.dataURL="//192.168.1.162:3000/fares.json",this.fetchData()},fetchData:function(){var e=this;fetch(this.dataURL).then(function(e){return e.json()}).then(function(t){e.data=t}).then(function(){e.buildParams()})},buildParams:function(){this.buildDestinationValues(),this.logSelectedDestination(),this.logSelectedWhen(),this.displayWhenHelperText(),this.logSelectedPurchaseLocation(),this.displayPurchaseHelperText(),this.displayTicketHelperText(),this.listenForDestinationChange(),this.listenForWhenChange(),this.listenForPurchaseLocationChange(),this.listenForTicketNumberUpdates(),this.accessSelectedValues()},buildDestinationValues:function(){var e=this;this.data.zones.forEach(function(t){var i=e.createNewElement({element:"option",classNames:[e.bemClass+"__option"],customAttributes:{value:t.name,"data-js-zone":t.zone}});i.innerHTML=t.name,e.destination.appendChild(i)})},logSelectedDestination:function(){this.selectedDestination=this.logSelectedValue(this.destination),this.selectedDestination.value=this.selectedDestination.getAttribute("data-js-zone")},logSelectedWhen:function(){this.selectedWhen=this.logSelectedValue(this.when),this.selectedWhen.value=this.selectedWhen.getAttribute("value")},logSelectedPurchaseLocation:function(e){var t=this;e?(this.selectedPurchaseLocation=e,this.selectedPurchaseLocation.value=e.value):this.purchaseLocations.forEach(function(e){e.checked&&(t.selectedPurchaseLocation=e,t.selectedPurchaseLocation.value=e.value)})},logNumberOfTickets:function(){this.selectedNumberOfTickets=this.tickets.value},displayWhenHelperText:function(){this.filterInfoValues(this.selectedWhen.value,this.whenHelperText)},displayPurchaseHelperText:function(){this.filterInfoValues(this.selectedPurchaseLocation.value,this.purchaseHelperText)},displayTicketHelperText:function(){var e=this.convertToNumber(this.selectedNumberOfTickets);this.selectedNumberOfTickets?isNaN(e)?this.ticketsHelperText.innerHTML="Please enter a number":this.ticketsHelperText.innerHTML="":this.ticketsHelperText.innerHTML="Please enter the number of tickets you need"},accessSelectedValues:function(){this.calculateTotal({time:this.selectedWhen.value,destZone:this.selectedDestination.value,purchLoc:this.selectedPurchaseLocation.value,tix:this.selectedNumberOfTickets})},calculateTotal:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.checkTicketPurchase(t.purchLoc,t.time),t.tix){if(isNaN(t.tix)){var i=this.stripValueToNumber(t.tix);isNaN(i)?t.tix=0:t.tix=i}this.data.zones.forEach(function(i){i.zone==t.destZone&&(e.chosenZone=i)}),this.chosenZone.fares.forEach(function(i){i.purchase==t.purchLoc&&i.type==t.time&&(i.trips!=t.tix&&"anytime"===t.time?e.savingsHelperText.innerHTML="NOTE: The Price above represents the "+i.trips+"-Trip Saver's discount Price for this ticket.<br>\n              To see an accurate price for "+t.tix+' trip(s), please select "Evenings & Weekends" or "Weekday" Riding Options':e.savingsHelperText.innerHTML="",e.fareSubtotal=i.price,i.trips>1&&(t.tix=1))}),this.rawPrice=this.fareSubtotal*t.tix,this.showFinalPrice()}},checkTicketPurchase:function(e,t){if("onboard_purchase"===e&&"anytime"===t){var i='NOTE: "Anytime" tickets MUST be purchased in advance.';this.whenHelperText.innerHTML=i,this.purchaseHelperText.innerHTML=i}else this.displayWhenHelperText(),this.displayPurchaseHelperText()},showFinalPrice:function(){this.finalPrice=this.rawPrice.toFixed(2),this.totalFare.innerHTML="$"+this.finalPrice},listenForDestinationChange:function(){var e=this;this.destination.addEventListener("change",function(){e.logSelectedDestination(),e.accessSelectedValues()})},listenForWhenChange:function(){var e=this;this.when.addEventListener("change",function(){e.logSelectedWhen(),e.displayWhenHelperText(),e.accessSelectedValues()})},listenForPurchaseLocationChange:function(){var e=this;this.purchaseLocations.forEach(function(t){t.addEventListener("change",function(t){e.logSelectedPurchaseLocation(t.target),e.displayPurchaseHelperText(),e.accessSelectedValues()})})},listenForTicketNumberUpdates:function(){var e=this;this.tickets.addEventListener("input",function(){e.logNumberOfTickets(),e.displayTicketHelperText(),e.accessSelectedValues()})},stripValueToNumber:function(e){return getNumbers=e.replace(/\D/g,""),finalValue=parseInt(getNumbers,10),finalValue},filterInfoValues:function(e,t){for(var i in this.data.info)i===e&&(t.innerHTML=this.data.info[i])},logSelectedValue:function(e){return e.options[e.selectedIndex]},easyDataJS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.name,e.selectAll,e.context)var t=e.context;else t=document;return e.selectAll?t.querySelectorAll('[data-js="'+e.name+'"]'):t.querySelector('[data-js="'+e.name+'"]')},createNewElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=document.createElement(e.element);if(e.classNames&&e.classNames.forEach(function(e){return t.classList.add(e)}),e.dataJS&&t.setAttribute("data-js",e.dataJS),e.customAttributes)for(var i in e.customAttributes)t.setAttribute(i,e.customAttributes[i]);return t},convertToNumber:function(e){return parseInt(e,10)}}).init()};"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?callback():document.addEventListener("DOMContentLoaded",callback);